<template>
  <div
    class="bg-secondary px-8 py-3 mx-auto sm:max-w-xl md:max-w-full md:px-24"
  >
    <div
      class="
        w-full
        relative
        max-w-screen-xl
        mx-auto
        flex
        justify-between
        items-center
      "
    >
      <!-- <div class="w-2/3 flex items-center"> -->
      <ul class="order-last lg:order-none flex items-center space-x-8 lg:flex">
        <div class="flex items-center mt-4 space-x-2 sm:mt-0">
          <a
            href="https://twitter.com/dolas_akash"
            class="
              text-white
              transition-colors
              duration-300
              hover:text-teal-accent-400
            "
          >
            <svg viewBox="0 0 24 24" fill="currentColor" class="w-8">
              <path
                d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"
              />
            </svg>
          </a>
          <a
            href="https://www.instagram.com/livingwithgravity/"
            class="
              text-white
              transition-colors
              duration-300
              hover:text-teal-accent-400
            "
          >
            <svg viewBox="0 0 24 24" fill="currentColor" class="w-8">
              <path
                d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z"
              />
            </svg>
          </a>
          <a
            href="https://www.facebook.com/LivingWithGravity/"
            class="
              text-white
              transition-colors
              duration-300
              hover:text-teal-accent-400
            "
          >
            <svg viewBox="0 0 24 24" fill="currentColor" class="w-8">
              <path
                d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z"
              />
            </svg>
          </a>
          <a
            href="https://www.youtube.com/user/akashdolas3"
            class="
              text-white
              transition-colors
              duration-300
              hover:text-teal-accent-400
            "
          >
            <svg viewBox="0 0 24 24" fill="currentColor" class="w-8">
              <path
                d="M8.051 1.999h.089c.822.003 4.987.033 6.11.335a2.01 2.01 0 0 1 1.415 1.42c.101.38.172.883.22 1.402l.01.104.022.26.008.104c.065.914.073 1.77.074 1.957v.075c-.001.194-.01 1.108-.082 2.06l-.008.105-.009.104c-.05.572-.124 1.14-.235 1.558a2.007 2.007 0 0 1-1.415 1.42c-1.16.312-5.569.334-6.18.335h-.142c-.309 0-1.587-.006-2.927-.052l-.17-.006-.087-.004-.171-.007-.171-.007c-1.11-.049-2.167-.128-2.654-.26a2.007 2.007 0 0 1-1.415-1.419c-.111-.417-.185-.986-.235-1.558L.09 9.82l-.008-.104A31.4 31.4 0 0 1 0 7.68v-.123c.002-.215.01-.958.064-1.778l.007-.103.003-.052.008-.104.022-.26.01-.104c.048-.519.119-1.023.22-1.402a2.007 2.007 0 0 1 1.415-1.42c.487-.13 1.544-.21 2.654-.26l.17-.007.172-.006.086-.003.171-.007A99.788 99.788 0 0 1 7.858 2h.193zM6.4 5.209v4.818l4.157-2.408L6.4 5.209z"
              />
            </svg>
          </a>
        </div>
      </ul>
      <div
        href="/"
        aria-label="Living with gravity"
        title="living with gravity"
        class="
          order-first
          lg:order-none
          inline-flex
          justofy-start
          lg:justify-center
          items-center
          lg:mx-auto
          w-2/4
        "
      >
        <a
          href="/"
          aria-label="Living with gravity"
          title="living with gravity"
          class=""
        >
          <jet-application-logo class="lg:block h-16 w-auto" />
        </a>
      </div>
      <!-- </div> -->
      <div class="relative w-1/4 hidden lg:flex items-center justify-between">
        <input
          class="
            w-full
            hidden
            lg:block
            bg-transparent
            border-b-2 border-t-0 border-l-0 border-r-0 border-gray-100
            py-3
            px-2
            text-white
            outline-none
            focus:outline-none
            active:outline-none
            focus:ring-gray-100
            active:ring-gray-100
          "
          @keyup="search('desktop')"
          v-model="query"
          type="text"
          placeholder="Search by brands, Body, Model..."
        />
        <div
          v-if="!errorMessage && bikes.length"
          id="search-list"
          class="
            absolute
            h-80
            z-50
            lg:w-90
            top-24
            bg-white
            border-2 border-[#2F2F2F]
            rounded-md
            overflow-y-scroll
            lg:-mt-8
          "
        >
          <div
            v-for="bike in bikes"
            :key="bike.id"
            class="flex py-4 px-2 items-center"
            @mouseover="isHovered(bike.id)"
            :class="{ 'bg-[#2F2F2F]': bikeHovered === bike.id }"
          >
            <a
              class="flex"
              :href="`/${bike.make}/${slugify(bike.series)}/${
                bike.version_name
              }`"
            >
              <img
                class="w-24 h-16 rounded-lg mr-4"
                :src="bike?.images[0]?.thumb_link"
                alt=""
              />
              <div
                :class="
                  bikeHovered === bike.id ? 'text-white' : 'text-gray-900'
                "
              >
                <h3 class="font-bold">
                  {{ bike.series }} {{ bike.version_name }}
                </h3>
                <span class="text-xs">Starting from</span>
                <p class="text-light italic">â‚¹{{ bike?.default_price }}</p>
              </div>
            </a>
          </div>
        </div>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="hidden lg:block h-6 w-6 text-white"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
          />
        </svg>
      </div>
      <!-- login/logout -->
      <div class="ml-3 relative" v-if="$page.props.user">
        <jet-dropdown align="right" width="48">
          <template #trigger>
            <button
              v-if="$page.props.user?.profile_photo_path"
              class="
                flex
                text-sm
                border-2 border-transparent
                rounded-full
                focus:outline-none focus:border-gray-300
                transition
              "
            >
              <img
                class="h-8 w-8 rounded-full object-cover"
                :src="$page.props.user?.profile_photo_path"
                :alt="$page.props.user?.name"
              />
            </button>

            <span v-else class="inline-flex rounded-md">
              <button
                type="button"
                class="
                  inline-flex
                  items-center
                  px-3
                  py-2
                  border border-transparent
                  text-sm
                  leading-4
                  font-medium
                  rounded-md
                  text-gray-500
                  bg-white
                  hover:text-gray-700
                  focus:outline-none
                  transition
                "
              >
                {{ $page.props.user?.name }}

                <svg
                  class="ml-2 -mr-0.5 h-4 w-4"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                    clip-rule="evenodd"
                  />
                </svg>
              </button>
            </span>
          </template>

          <template #content>
            <!-- Account Management -->
            <div class="block px-4 py-2 text-xs text-gray-400">
              Manage Account
            </div>

            <jet-dropdown-link :href="route('dashboard')">
              Profile
            </jet-dropdown-link>

            <div class="border-t border-gray-100"></div>

            <!-- Authentication -->
            <form @submit.prevent="logout">
              <jet-dropdown-link as="button"> Log Out </jet-dropdown-link>
            </form>
          </template>
        </jet-dropdown>
      </div>
    </div>
    <div class="relative">
      <input
        class="
          w-full
          bg-transparent
          lg:hidden
          border-b-2 border-t-0 border-l-0 border-r-0 border-gray-100
          py-3
          px-2
          text-white
          outline-none
          focus:outline-none
          active:outline-none
          focus:ring-transparent
          active:ring-transparent
        "
        @keyup="search('mobile')"
        v-model="query"
        type="text"
        placeholder="Search by brand, Body, Model..."
      />
      <div
        v-if="!errorMessage && bikes.length && isMobile"
        id="search-list"
        class="
          absolute
          h-144
          z-50
          top-24
          bg-white
          border-2 border-[#2F2F2F]
          rounded-md
          overflow-y-scroll
          -mt-10
        "
      >
        <div
          v-for="bike in bikes"
          :key="bike.id"
          class="flex py-4 px-2 items-center"
          @mouseover="isHovered(bike.id)"
          :class="{ 'bg-[#2F2F2F]': bikeHovered === bike.id }"
        >
          <a
            class="flex"
            :href="`/${bike.make}/${slugify(bike.series)}/${bike.version_name}`"
          >
            <img
              class="w-24 h-16 rounded-lg mr-4"
              :src="bike?.images[0]?.thumb_link"
              alt=""
            />
            <div
              :class="bikeHovered === bike.id ? 'text-white' : 'text-gray-900'"
            >
              <h3 class="font-bold">
                {{ bike.series }} {{ bike.version_name }}
              </h3>
              <span class="text-xs">Starting from</span>
              <p class="text-light italic">â‚¹{{ bike?.default_price }}</p>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="bg-gradient-to-r from-[#f84270] to-[#fe803b]">
    <div class="w-full py-3 px-4 lg:mx-auto md:max-w-screen-xl">
      <div class="relative flex items-center xl:justify-between">
        <div class="flex items-center px-2">
          <ul class="flex items-center hidden space-x-14 lg:flex">
            <li>
              <a
                href="https://livingwithgravity.com/category/news/"
                target="_blank"
                aria-label="News"
                title="News"
                class="
                  text-sm
                  font-bold
                  uppercase
                  space-x-4
                  tracking-wide
                  flex
                  items-center
                  text-gray-100
                  transition-colors
                  duration-200
                  hover:text-deep-purple-accent-400
                "
                >News
              </a>
            </li>
            <li>
              <a
                href="https://livingwithgravity.com/category/how-to/"
                target="_blank"
                aria-label="Buyers Guide"
                title="Buyers Guide"
                class="
                  text-sm
                  font-bold
                  uppercase
                  space-x-4
                  tracking-wide
                  flex
                  items-center
                  text-gray-100
                  transition-colors
                  duration-200
                  hover:text-deep-purple-accent-400
                "
                >Buyers Guide
              </a>
            </li>
            <li>
              <a
                href="https://livingwithgravity.com/category/racing/"
                target="_blank"
                aria-label="Racing"
                title="Racing"
                class="
                  text-sm
                  font-bold
                  uppercase
                  space-x-4
                  tracking-wide
                  flex
                  items-center
                  text-gray-100
                  transition-colors
                  duration-200
                  hover:text-deep-purple-accent-400
                "
                >Racing
              </a>
            </li>
            <li>
              <a
                href="https://livingwithgravity.com/category/electric-bikes/"
                target="_blank"
                aria-label="Electric"
                title="Electric"
                class="
                  text-sm
                  font-bold
                  uppercase
                  space-x-4
                  tracking-wide
                  flex
                  items-center
                  text-gray-100
                  transition-colors
                  duration-200
                  hover:text-deep-purple-accent-400
                "
              >
                Electric
              </a>
            </li>
            <li>
              <a
                href="https://livingwithgravity.com/category/expert-talks/"
                target="_blank"
                aria-label="Interviews"
                title="Interviews"
                class="
                  text-sm
                  font-bold
                  uppercase
                  space-x-4
                  tracking-wide
                  flex
                  items-center
                  text-gray-100
                  transition-colors
                  duration-200
                  hover:text-deep-purple-accent-400
                "
              >
                Interviews
              </a>
            </li>
            <li>
              <a
                href="https://livingwithgravity.com/"
                target="_blank"
                aria-label="Blog"
                title="Blog"
                class="
                  text-sm
                  font-bold
                  uppercase
                  space-x-4
                  tracking-wide
                  flex
                  items-center
                  text-gray-100
                  transition-colors
                  duration-200
                  hover:text-deep-purple-accent-400
                "
              >
                Blog
              </a>
            </li>
            <li>
              <a
                href="https://livingwithgravity.com/about"
                target="_blank"
                aria-label="About us"
                title="About us"
                class="
                  text-sm
                  font-bold
                  uppercase
                  space-x-4
                  tracking-wide
                  flex
                  items-center
                  text-gray-100
                  transition-colors
                  duration-200
                  hover:text-deep-purple-accent-400
                "
              >
                About us
              </a>
            </li>
            <li>
              <a
                href="https://livingwithgravity.com/contact"
                target="_blank"
                aria-label="Contact us"
                title="Contact us"
                class="
                  text-sm
                  font-bold
                  uppercase
                  space-x-4
                  tracking-wide
                  flex
                  items-center
                  text-gray-100
                  transition-colors
                  duration-200
                  hover:text-deep-purple-accent-400
                "
              >
                Contact us
              </a>
            </li>
          </ul>
        </div>
        <ul class="items-center hidden space-x-8 lg:flex">
          <li
            @click="selectCity = !selectCity"
            class="
              flex
              border-l-4
              items-center
              justify-center
              h-12
              px-1
              xl:px-6
              font-bold
              uppercase
              tracking-wide
              text-white
              transition
              duration-200
              bg-deep-purple-accent-400
              hover:bg-deep-purple-accent-700
              focus:shadow-outline focus:outline-none
              cursor-pointer
            "
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-6 w-6 text-red-500"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
              />
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
              />
            </svg>

            <span
              class="
                flex
                items-center
                justify-center
                h-12
                px-2
                font-bold
                text-sm
                uppercase
                tracking-wide
                text-white
                transition
                duration-200
                bg-deep-purple-accent-400
                hover:bg-deep-purple-accent-700
                focus:shadow-outline focus:outline-none
              "
              >{{ cityName }}</span
            >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-6 w-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"
              />
            </svg>
          </li>
        </ul>
        <div class="lg:hidden">
          <button
            aria-label="Open Menu"
            title="Open Menu"
            class="
              p-2
              -mr-1
              transition
              duration-200
              rounded
              focus:outline-none focus:shadow-outline
              hover:bg-deep-purple-50
              focus:bg-deep-purple-50
            "
            @click="isMenuOpen = true"
          >
            <svg class="w-5 text-gray-600" viewBox="0 0 24 24">
              <path
                fill="currentColor"
                d="M23,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h22c0.6,0,1,0.4,1,1S23.6,13,23,13z"
              ></path>
              <path
                fill="currentColor"
                d="M23,6H1C0.4,6,0,5.6,0,5s0.4-1,1-1h22c0.6,0,1,0.4,1,1S23.6,6,23,6z"
              ></path>
              <path
                fill="currentColor"
                d="M23,20H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h22c0.6,0,1,0.4,1,1S23.6,20,23,20z"
              ></path>
            </svg>
          </button>
          <div v-if="isMenuOpen" class="absolute top-0 left-0 w-full">
            <div
              class="relative z-50 p-5 bg-secondary border rounded shadow-sm"
            >
              <div
                class="text-xl text-white font-bold flex justify-end"
                @click="isMenuOpen = !isMenuOpen"
              >
                x
              </div>
              <nav>
                <ul class="space-y-4">
                  <li>
                    <a
                      href="https://livingwithgravity.com/category/news/"
                      target="_blank"
                      aria-label="News"
                      title="News"
                      class="
                        font-medium
                        uppercase
                        space-x-4
                        tracking-wide
                        flex
                        text-gray-100
                        transition-colors
                        duration-200
                        hover:text-deep-purple-accent-400
                      "
                      >News
                    </a>
                  </li>
                  <li>
                    <a
                      href="https://livingwithgravity.com/category/how-to/"
                      target="_blank"
                      aria-label="Bike Guides"
                      title="Bike Guides"
                      class="
                        font-medium
                        uppercase
                        space-x-4
                        tracking-wide
                        flex
                        text-gray-100
                        transition-colors
                        duration-200
                        hover:text-deep-purple-accent-400
                      "
                      >Bike Guides
                    </a>
                  </li>
                  <li>
                    <a
                      href="https://livingwithgravity.com/category/racing/"
                      target="_blank"
                      aria-label="Racing"
                      title="Racing"
                      class="
                        text-sm
                        font-bold
                        uppercase
                        space-x-4
                        flex
                        items-center
                        tracking-wide
                        text-gray-100
                        transition-colors
                        duration-200
                        hover:text-deep-purple-accent-400
                      "
                      >Racing
                    </a>
                  </li>
                  <li>
                    <a
                      href="https://livingwithgravity.com/category/electric-bikes/"
                      target="_blank"
                      aria-label="Electric"
                      title="Electric"
                      class="
                        font-medium
                        uppercase
                        space-x-4
                        tracking-wide
                        flex
                        text-gray-100
                        transition-colors
                        duration-200
                        hover:text-deep-purple-accent-400
                      "
                      >Electric
                    </a>
                  </li>
                  <li>
                    <a
                      href="https://livingwithgravity.com/category/expert-talks/"
                      target="_blank"
                      aria-label="Interviews"
                      title="Interviews"
                      class="
                        font-medium
                        uppercase
                        space-x-4
                        tracking-wide
                        flex
                        text-gray-100
                        transition-colors
                        duration-200
                        hover:text-deep-purple-accent-400
                      "
                    >
                      Interviews
                    </a>
                  </li>
                  <li>
                    <a
                      href="https://livingwithgravity.com/"
                      target="_blank"
                      aria-label="Blog"
                      title="Blog"
                      class="
                        font-medium
                        uppercase
                        space-x-4
                        tracking-wide
                        flex
                        text-gray-100
                        transition-colors
                        duration-200
                        hover:text-deep-purple-accent-400
                      "
                    >
                      Blog
                    </a>
                  </li>
                  <li>
                    <a
                      href="https://livingwithgravity.com/about"
                      target="_blank"
                      aria-label="About us"
                      title="About us"
                      class="
                        font-medium
                        uppercase
                        space-x-4
                        tracking-wide
                        flex
                        text-gray-100
                        transition-colors
                        duration-200
                        hover:text-deep-purple-accent-400
                      "
                    >
                      About us
                    </a>
                  </li>
                  <li>
                    <a
                      href="https://livingwithgravity.com/contact"
                      target="_blank"
                      aria-label="Contact us"
                      title="Contact us"
                      class="
                        font-medium
                        uppercase
                        space-x-4
                        tracking-wide
                        flex
                        text-gray-100
                        transition-colors
                        duration-200
                        hover:text-deep-purple-accent-400
                      "
                    >
                      Contact us
                    </a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
      <city-modal
        v-if="selectCity"
        @city-selected="citySelected()"
      ></city-modal>
    </div>
  </div>
</template>

<script>
import JetApplicationLogo from "@/Jetstream/ApplicationLogo.vue";
import JetDropdown from "@/Jetstream/Dropdown.vue";
import JetDropdownLink from "@/Jetstream/DropdownLink.vue";
import CityModal from "./CityModal.vue";

export default {
  components: {
    JetApplicationLogo,
    JetDropdown,
    JetDropdownLink,
    CityModal,
  },
  data() {
    return {
      isMenuOpen: false,
      selectCity: false,
      cityName: localStorage.getItem("citySelectedName") ?? "Bangalore",
      query: null,
      errorMessage: null,
      bikes: [],
      bikeHovered: null,
      isMobile: false,
    };
  },
  beforeMount() {
    const citySelectedName = localStorage.getItem("citySelectedName");
    const citySelectedId = localStorage.getItem("citySelectedId");

    if (!citySelectedName) {
      localStorage.setItem("citySelectedName", "Bangalore");
    }
    if (!citySelectedId) {
      localStorage.setItem("citySelectedId", 1);
    }
  },
  mounted() {
    var emitter = require("tiny-emitter/instance");

    emitter.on("city-selected", (val) => {
      this.cityName = val.city_name;
    });

    document.addEventListener("click", (evt) => {
      const flyoutElement = document.getElementById("search-list");
      let targetElement = evt.target; // clicked element

      do {
        if (targetElement == flyoutElement) {
          // This is a click inside. Do nothing, just return.
          console.log("click inside");
          return;
        }
        // Go up the DOM
        targetElement = targetElement.parentNode;
      } while (targetElement);

      // This is a click outside.
      this.bikes = [];
      this.query = null;
    });
  },
  methods: {
    citySelected() {
      this.cityName = localStorage.getItem("citySelectedName");
    },
    search(val) {
      if (val === "mobile") {
        this.isMobile = true;
      } else {
        this.isMobile = false;
      }
      if (this.query.length >= 3) {
        this.errorMessage = null;
        axios
          .post("/search", {
            query: this.query,
          })
          .then((res) => {
            this.bikes = res.data;
          })
          .catch((err) => {
            console.log(err);
          });
      } else {
        this.errorMessage = "Please type 3 or more letters";
      }
    },
    isHovered(id) {
      this.bikeHovered = id;
    },
    slugify(text) {
      return text
        .toLowerCase()
        .replace(/ /g, "-")
        .replace(/[^\w-]+/g, "");
    },
    logout() {
      this.$inertia.post(route("logout"));
    },
  },
};
</script>
